<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>AR Dashboard Fix</title>

    <script src="https://cdn.jsdelivr.net/npm/aframe@1.4.2/dist/aframe-master.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

    <script>
        // 1. SLIDESHOW COMPONENT
        AFRAME.registerComponent('slideshow', {
            init: function() {
                const el = this.el;
                const images = [
                    "https://placehold.co/400x300/orange/white?text=Slide+1", 
                    "https://placehold.co/400x300/purple/white?text=Slide+2", 
                    "https://placehold.co/400x300/green/white?text=Slide+3"
                ];
                let index = 0;
                setInterval(() => {
                    index = (index + 1) % images.length;
                    el.setAttribute('src', images[index]);
                }, 2000); 
            }
        });

        // 2. CLICKABLE LINK COMPONENT
        AFRAME.registerComponent('social-link', {
            schema: { url: {type: 'string'} },
            init: function() {
                this.el.addEventListener('click', () => {
                    alert("Opening: " + this.data.url); 
                });
            }
        });

        // 3. MAIN LOGIC (Hide Loader)
        window.addEventListener('load', () => {
            const loader = document.getElementById('loader');

            AFRAME.registerComponent('markerhandler', {
                init: function () {
                    this.el.addEventListener('markerFound', () => {
                        console.log("✅ Marker Found");
                        loader.style.display = 'none'; // HIDE LOADING SCREEN
                    });
                    this.el.addEventListener('markerLost', () => {
                        console.log("❌ Marker Lost");
                    });
                }
            });
        });
    </script>
</head>

<body style="margin: 0; overflow: hidden;">

    <div id="loader" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 999;">
        <div>Loading...</div>
        <div style="font-size: 12px; margin-top: 10px;">Point camera at image</div>
    </div>

    <a-scene
        vr-mode-ui="enabled: false;"
        renderer="logarithmicDepthBuffer: true;"
        embedded
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
        cursor="rayOrigin: mouse" 
        raycaster="objects: .clickable">

        <a-nft
            markerhandler
            type="nft"
            url="https://Kav1nduAkalanka.github.io/AR_website/assests/nft"
            smooth="true"
            smoothCount="10"
            smoothTolerance="0.01"
            smoothThreshold="5">

            <a-box 
                color="blue"
                position="-100 0 -150"
                scale="50 50 50"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 4000">
            </a-box>

            <a-image
                slideshow
                src="https://placehold.co/400x300/orange/white?text=Loading..."
                width="150" height="100"
                position="150 0 -150"
                rotation="-90 0 0">
            </a-image>

            <a-plane 
                color="red" 
                opacity="0.5" 
                width="350" height="60" 
                position="0 -1 80" 
                rotation="-90 0 0">
            </a-plane>

            <a-image 
                src="https://placehold.co/100x100/3b5998/white?text=FB"
                class="clickable"
                social-link="url: Facebook"
                width="40" height="40"
                position="-120 0 80"
                rotation="-90 0 0">
            </a-image>

            <a-image 
                src="https://placehold.co/100x100/0077b5/white?text=LI"
                class="clickable"
                social-link="url: LinkedIn"
                width="40" height="40"
                position="-40 0 80"
                rotation="-90 0 0">
            </a-image>

            <a-image 
                src="https://placehold.co/100x100/333/white?text=GH"
                class="clickable"
                social-link="url: GitHub"
                width="40" height="40"
                position="40 0 80"
                rotation="-90 0 0">
            </a-image>

            <a-image 
                src="https://placehold.co/100x100/e91e63/white?text=WEB"
                class="clickable"
                social-link="url: Website"
                width="40" height="40"
                position="120 0 80"
                rotation="-90 0 0">
            </a-image>

        </a-nft>

        <a-entity camera></a-entity>
    </a-scene>
</body>
</html>